nie.util.qUrs=nie.util.qUrs||function(B){$("head").append($("<link>").attr({rel:"dns-prefetch",href:"//weburs.ku.163.com"})).append($("<link>").attr({rel:"dns-prefetch",href:"//reg.nie.163.com"}));var s=function(){return(new Date).getTime()},q=new function(){var a=this,b=!1,c=0,d=s();this.run=function(a){(new Image).src="http://webdog.nie.163.com/urs_log/?"+w({promark:x,type:a,preType:c,time:s()-d});c=a;d=s()};this.touch=function(){b||(b=!0,a.run(2))}},y={holder:"div.NIE-quickReg",type:1,loginFn:null,
regComplete:null,msgType:1,product:nie.config.site||window.location.href.replace(/^http:\/\/(.*)\.163\.com.*$/,"$1"),activity:[]},o=$.extend({},y,B),G=function(a){if(typeof a=="object"){var b="",b=a.reVer?"reVer":a.success?a.regType==1?a.is163Mail?"is163":"not163":"mobile":"error";i.create(b);i[b].show(a)}$.isFunction(o.regComplete)&&o.regComplete(a)},t=$(o.holder),x=t.find("input[name=promark]").val(),C=null,z=new function(){var a=this,b=!1,c=0;this.firstStart=function(){b||a.start()};this.start=
function(){b=!0;c=s()};this.end_and_get=function(){var b=parseInt((s()-c)/1E3);a.start();return b}},n=function(a,b,c){var d=h.currentItems.getVal(h.getCurrentUA());if(D.test(d)&&a==2||/^(13|14|15|18)\d{9}$/.test(d)&&a==1)a={account:d,account_type:a,product:o.product},typeof c!="undefined"&&(a.fail_type=c),typeof b!="undefined"&&(a.is_success=b),H().attr("src","http://gad.netease.com/gad/register?"+w(a))},N=function(a,b){for(var c=function(a,b){var c="";b.name=="captcha"?c='<span class="captcha-wrap hideItem qr-loading"></span>':
b.name=="username"?(c="<div class=suggestDomain><ul></ul></div>",f='<p class="qr-noEmail"><a href="javascript:void(0);">\u8fd8\u6ca1\u6709\u90ae\u7bb1\uff1f</a></p>'):b.name=="smscode"&&(l=!0,c='<input type="button" class="qr-smscode-btn" value="\u83b7\u53d6\u9a8c\u8bc1\u7801"/>');return('<dt class="qr-$name">$cn\uff1a</dt>\t\t\t\t\t\t\t<dd class="qr-$name">\t\t\t\t\t\t\t<ul>\t\t\t\t\t\t\t\t<li class="qrCon">\t\t\t\t\t\t\t\t\t<input class="qr-$name-inp qrInpTxt" type="'+(/password/.test(b.name)?"password":
"text")+'" value="$defaultValue" name="$name" autocomplete="off" tabindex="$index" />\t\t\t\t\t\t\t\t\t<input rel="$name" class="qr-$name-inp qr-inp-error qr-hide" readonly="readonly" tabindex="$index" />'+c+'</li>\t\t\t\t\t\t\t\t<li class="qrChk"><i class="qr-right"></i><i class="qr-error"></i><i class="qr-loading"></i></li>\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</dd>').replace(/\$index/g,a).replace(/\$name/g,b.name).replace(/\$cn/g,b.cn).replace(/\$defaultValue/g,b.defaultValue?b.defaultValue:"")},d=
'<dt class="qr-agree"><input id="qr-agree" name="agree" type="checkbox" checked="checked" /></dt>\t\t\t\t\t\t<dd class="qr-agree">\t\t\t\t\t\t<label for="qr-agree">\u6211\u540c\u610f"<a href="http://reg.163.com/agreement.shtml" target="_blank">\u670d\u52a1\u6761\u6b3e</a>"\u548c<br />"<a href="http://reg.163.com/agreement_game.shtml" target="_blank">\u9690\u79c1\u4fdd\u62a4\u548c\u4e2a\u4eba\u4fe1\u606f\u5229\u7528\u653f\u7b56</a>"</label>\t\t\t\t\t\t</dd>\t\t\t\t\t\t<dt class="qr-submit"></dt>\t\t\t\t\t\t<dd class="qr-submit"><input type="submit" tabindex="$index" value=""/></dd>',
e="",m=0,l=!1,f="",j=$("<form>",{"class":"qr-form"+(b+1)}).submit(function(){return!1}),g=0,M=a.length;g<M;g++)e+=c(++m,a[g]);j.html(f+"<dl>"+e+d.replace("$index",m+1)+"</dl>");j.find("p.qr-noEmail>a").click(function(){$(this).text("\u53ef\u5728\u6b64\u6ce8\u518c\u65b0\u7f51\u6613\u90ae\u7bb1");h.currentItems.get("username").hiLine()});l&&j.find("input.qr-smscode-btn").click(function(){h.currentItems.get("smscode").none();var a=$(this).attr("disabled","disabled"),b=61,c=a.val();h.currentItems.get("m_username").chk(function(d){d?
r("sendMobileCaptcha",{m_username:h.currentItems.getVal("m_username")},function(d){if(d.success)var g=setInterval(function(){--b>0?a.val(b+"\u79d2\u540e\u53ef\u91cd\u65b0\u53d1\u9001"):(clearInterval(g),a.val(c).attr("disabled",!1))},1E3);else a.val(c).attr("disabled",!1),d.uploadSMS?(i.create("uploadSMS"),i.uploadSMS.show(d)):(i.create("error"),i.error.show(d),d.isReded?n(1,0,1):n(1,0,2))}):a.attr("disabled",!1)})});l=c=d=e=m=null;return j},J={username:{asy:!0,rule:function(a,b){var c=!0,d=a.match(D),
e=h.currentItems.getVal("password"),m=!1;a==""||a==k.username.txt?c="\u8bf7\u8f93\u5165\u90ae\u4ef6\u5730\u5740":d?a==e||d[1]==e?c="\u4e0d\u80fd\u4e0e\u5bc6\u7801\u76f8\u540c":(e=d[2].toLowerCase(),A[e]&&A[e][1]&&(m=!0,c=O(d[1]))):c="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740";c!=!0?b(c):r("checkUserName",{userName:a},function(a){var c=0;switch(a.status){case 104:c=!0;n(2);break;case 200:I(m);m?(c="\u8be5\u5e10\u53f7\u53ef\u76f4\u63a5\u767b\u5f55\u6e38\u620f",$.isFunction(o.loginFn)&&
o.loginFn()):c="\u8be5\u90ae\u4ef6\u5730\u5740\u5df2\u88ab\u6ce8\u518c";n(2,0,3);n(2);break;default:c=a.info}b(c)})}},password:{rule:function(a){var b=!0,c=h.currentItems.getVal("username"),d=c.match(D);a==""?b="\u8bf7\u8bbe\u7f6e\u4f60\u7684\u901a\u884c\u8bc1\u767b\u5f55\u5bc6\u7801":a==c||d&&d[1]==a?b="\u4e0d\u80fd\u548c\u7528\u6237\u540d\u76f8\u540c":/^[\S]{6,16}$/i.test(a)?h.currentItems.getVal("repassword")&&h.currentItems.blur("repassword"):b="\u8bf7\u8f93\u51656\u523016\u4e2a\u5b57\u7b26\u7684\u5bc6\u7801";
return b}},repassword:{rule:function(a){var b=!0;return b=a==""?"\u8bf7\u518d\u6b21\u8f93\u5165\u4f60\u7684\u8bbe\u7f6e\u5bc6\u7801":a==h.currentItems.getVal("password")?!0:"\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4"}},captcha:{asy:!0,rule:function(a,b){var c=!0,d=o.type==1?["\u5fc5\u586b","\u4e0d\u6b63\u786e"]:["\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801"];if(a=="")c=d[0];else if(a.length<4||a.length>6)c=d[1];c!=!0?b(c):r("Verifier",
{val:a},function(a){var c=0;switch(a.verCapResult){case 0:c=!0;break;case 1:c=d[1];E();break;case 2:c="\u5931\u8d25\u6b21\u6570\u591a\uff0c\u8bf7\u7a0d\u5019\u8f93\u5165"}b(c)})}},m_username:{rule:function(a){a=/^(13|14|15|18)\d{9}$/.test(a)?!0:"\u8bf7\u6b63\u786e\u8f93\u5165\u624b\u673a\u53f7\u7801";n(1);return a}},m_password:{rule:function(a){var b=!0;a==""?b="\u8bf7\u8bbe\u7f6e\u4f60\u7684\u901a\u884c\u8bc1\u767b\u5f55\u5bc6\u7801":a==h.currentItems.getVal("m_username")?b="\u4e0d\u80fd\u548c\u7528\u6237\u540d\u76f8\u540c":
/^[\S]{6,16}$/i.test(a)?h.currentItems.getVal("m_repassword")&&h.currentItems.blur("m_repassword"):b="\u8bf7\u8f93\u51656\u523016\u4e2a\u5b57\u7b26\u7684\u5bc6\u7801";return b}},m_repassword:{rule:function(a){var b=!0;return b=a==""?"\u8bf7\u518d\u6b21\u8f93\u5165\u4f60\u7684\u8bbe\u7f6e\u5bc6\u7801":a==h.currentItems.getVal("m_password")?!0:"\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4"}},smscode:{rule:function(a){return a==""?"\u5fc5\u586b":!0}}},i={size:{not163:{w:435,h:250},is163:{w:300,
h:155},reVer:{w:240,h:230},error:{w:280,h:160},mobile:{w:370,h:175},uploadSMS:{w:320,h:200},sendEMail:{w:280,h:160}},is163:null,not163:null,error:null,reVer:null,mobile:null,uploadSMS:null,sendEMail:null,bg:null,create:function(a){var b=$(document.body);if(!i[a]){i[a]=new function(){var c=this,d=function(b,d){return a=="not163"?null:$("<a>",{text:b,"class":d,href:"javascript:void(0);",click:function(){c.hide()}})},e=function(a,b){return m.find(a).click(function(){c.hide();$.isFunction(b)&&b()})},
m=$("<div>",{"class":"NIE-quickReg-msg-con qr-con-"+("is163"==a?"right":a)}),l=i.size[a];if(o.msgType==1){var f=$("<div>",{"class":"NIE-quickReg-msg",html:"<div class=NIE-quickReg-msg-title>\u6ce8\u518c\u6e38\u620f\u5e10\u53f7</div>"}).append(d("X","NIE-quickReg-closeBtn")),j=function(a,b){m.empty().html(a);b&&m.append(b);i.bg.show();var c=$(window),d=c.height()-l.h,e=c.width()-l.w;f.css({width:l.w,height:l.h,top:(d<0?0:d)/2+c.scrollTop()+20,left:(e<0?0:e)/2+c.scrollLeft(),opacity:0}).append(m).show().animate({opacity:1,
top:parseInt(f.css("top"))-20},{duration:250})};this.hide=function(){f.animate({opacity:0,top:parseInt(f.css("top"))+20},{duration:250,complete:function(){$(this).hide()}});i.bg.hide()}}else f=$("<div>",{"class":"NIE-quickReg-msg-iframe"}),j=function(a,b){t.hide();m.empty().html(a);b&&m.append(b);$(window);f.append(m).show()},this.hide=function(){f.hide();t.show()};switch(a){case "is163":this.show=function(a){j('<p class="qr-info">\u6ce8\u518c\u6210\u529f\uff01</p><p>\u4f60\u7684\u7f51\u6613\u901a\u884c\u8bc1\u4e3a '+
(a.m_username?a.m_username:a.username)+'</p><a href="'+a.url+'" target="_blank" class="btn">\u786e \u8ba4</a>');e("a")};break;case "not163":this.show=function(a){j('<h1>\u611f\u8c22\u6ce8\u518c\uff01\u8bf7\u7acb\u5373\u6fc0\u6d3b\u5e10\u53f7\u3002</h1>\t\t\t\t\t\t\t\t\t\t\t<h3>\u8bf7\u60a8\u767b\u5f55\u90ae\u7bb1 <b><a href="'+a.mailUrl+'" target="_blank">'+a.username+'</a></b> \u6839\u636e\u786e\u8ba4\u90ae\u4ef6\u64cd\u4f5c\u5373\u53ef\u3002</h3>\t\t\t\t\t\t\t\t\t\t\t<h2><a class="btn" href="'+
a.mailUrl+'" target="_blank">\u7acb\u5373\u67e5\u770b\u90ae\u4ef6</a></h2>\t\t\t\t\t\t\t\t\t\t\t<ul class="tips">\t\t\t\t\t\t\t\t\t\t\t<li>\u8fd8\u6ca1\u6709\u6536\u5230\u9a8c\u8bc1\u90ae\u4ef6\uff1f\t\t\t\t\t\t\t\t\t\t\t<ol>\t\t\t\t\t\t\t\t\t\t\t<li>\u5c1d\u8bd5\u5230\u5e7f\u544a\u90ae\u4ef6\u3001\u5783\u573e\u90ae\u4ef6\u91cc\u627e\u627e\u770b\uff1b</li>\t\t\t\t\t\t\t\t\t\t\t<li>\u518d\u6b21<a href="javascript:void(0);" target="_self" class="sendMailBtn">\u53d1\u9001\u6ce8\u518c\u9a8c\u8bc1\u90ae\u4ef6</a>\uff1b</li>\t\t\t\t\t\t\t\t\t\t\t<li>\u5982\u679c\u91cd\u53d1\u6ce8\u518c\u9a8c\u8bc1\u90ae\u4ef6\u4f9d\u7136\u6ca1\u6709\u6536\u5230\uff0c\u8bf7<a class="reReg" target="_self" href="javascript:void(0);">\u91cd\u65b0\u6ce8\u518c</a>\u3002</li>\t\t\t\t\t\t\t\t\t\t\t</ol>\t\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t\t</ul>');
(function(){var b=a.mailUrl;m.find("a.sendMailBtn").click(function(){r("sendActiveMail",{userName:a.username},function(a){a.status&&a.info&&(a.status==200?(f.hide(),i.create("sendEMail"),i.sendEMail.show(a.info,b)):alert(a.info))})})})();e("a.reReg",function(){h.currentItems.get("username").hiLine()});e("a.btn")};break;case "mobile":this.show=function(a){j("<h1>\u6ce8\u518c\u6210\u529f\uff01</h1>\t\t\t\t\t\t\t\t\t\t\t<h2>\u60a8\u7684\u7f51\u6613\u901a\u884c\u8bc1\u4e3a<b>"+a.m_username+'</b></h2>\t\t\t\t\t\t\t\t\t\t\t<p><a href="'+
a.url+'" target="_blank" class="btn">\u786e \u8ba4</a></p>');e("a")};break;case "error":this.show=function(a){var b="";h.getCurrentRegType()==2&&(a.status==421||a.msg=="\u8be5\u624b\u673a\u53f7\u5df2\u88ab\u6ce8\u518c\u3002")?(b='\u53f7\u7801\u5df2\u88ab\u6ce8\u518c\u6216\u4e0e\u539f\u6709\u5e10\u53f7\u5173\u8054\uff0c\u8bf7\u76f4\u63a5\u767b\u5f55\u6216<a rel="emailReg" href="javascript:void(0);">\u90ae\u7bb1\u6ce8\u518c</a>\u3002',h.currentItems.get("m_username").error("\u53f7\u7801\u5df2\u88ab\u6ce8\u518c\u6216\u88ab\u5173\u8054")):
b=a.msg;j('<p class="qr-info">\u51fa\u9519\u4e86\uff01</p><p class="qr-reason">'+b+"</p>",d("\u786e\u8ba4","btn"));b=null;e("a[rel=emailReg]").click(function(){h.active("\u90ae\u7bb1\u6ce8\u518c")})};break;case "uploadSMS":this.show=function(a){j('<p class="qr-info">\u7f16\u8f91\u77ed\u4fe1\u83b7\u53d6\u9a8c\u8bc1\u7801</p><p class="qr-reason">\u8bf7\u7528\u624b\u673a <span class="qr-f-hiKey">'+h.currentItems.getVal("m_username")+'</span> \u7f16\u8f91\u77ed\u4fe1<span class="qr-f-hiKey">'+a.uploadSMS.content+
'</span>\uff0c\u53d1\u9001\u5230 <span class="qr-f-hiKey">'+a.uploadSMS.No+'</span> \u83b7\u53d6\u9a8c\u8bc1\u7801\u4fe1\u606f<br><span class="qr-f-lowKey">\u77ed\u4fe1\u8d39\u7528\u7531\u8fd0\u8425\u5546\u6536\u53d6\uff080.1\u5143/\u6761\uff09</span></p>',d("\u786e\u8ba4","btn"))};break;case "reVer":this.show=function(){j('<p class="reVer-l1">\u53ea\u5dee\u4e00\u6b65\u5c31\u5b8c\u6210\u4e86\uff01<br>\t\t\t\t\t\t\t\t\t\t\t\u8bf7\u60a8\u518d\u8f93\u5165\u4e00\u6b21\u9a8c\u8bc1\u7801\u4ee5\u5b8c\u6210\u6ce8\u518c\uff1a<br>\t\t\t\t\t\t\t\t\t\t\t<input class="NIE-reVerInp"><br>\t\t\t\t\t\t\t\t\t\t\t<span class="NIE-reVerImg">\t\t\t\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t\t\t\t</p>\t\t\t\t\t\t\t\t\t\t\t<p class="reVer-l2">\u770b\u4e0d\u6e05\u695a \t\t\t\t\t\t\t\t\t\t\t<a href="javascript:void(0);" class="NIE-reVerBtn">\u6362\u4e00\u4e2a</a>\t\t\t\t\t\t\t\t\t\t\t</p>\t\t\t\t\t\t\t\t\t\t\t<p class="reVer-l3">\t\t\t\t\t\t\t\t\t\t\t<a href="javascript:void(0);" class="btn">\u5b8c\u6210\u6ce8\u518c</a>\t\t\t\t\t\t\t\t\t\t\t</p>');
var a=function(){u.load(!0,function(b){b.click(a);m.find("span.NIE-reVerImg").empty().append(b)})};a();m.find("a.NIE-reVerBtn").click(a);m.find("a.btn").click(function(){var a=h.currentItems.getItemVals();a.captcha=$.trim(m.find("input.NIE-reVerInp").val());a.pAnti=1;K(a,function(){c.hide()});a=null})};break;case "sendEMail":this.show=function(a,b){j('<p class="qr-info">\u90ae\u4ef6\u53d1\u9001\u6210\u529f\uff01</p><p>\u9a6c\u4e0a\u53bb\u60a8\u7684\u90ae\u7bb1\u6fc0\u6d3b\u901a\u884c\u8bc1\u3002</p><a href="'+
b+'" target="_blank" class="btn">\u7acb\u5373\u67e5\u770b\u90ae\u4ef6</a>');e("a")}}f.appendTo(b)};if(o.msgType==1&&!i.bg)i.bg=new function(){var a=$("<div>",{"class":"NIE-quickReg-msg-bg"}).appendTo(b);this.show=function(){a.css("opacity")==1&&a.css({width:$(document.body).width(),height:$(document).height(),opacity:0}).show().animate({opacity:0.5},{duration:130})};this.hide=function(){a.animate({opacity:0},{duration:130,complete:function(){$(this).hide()}})}};b=null}}},v=!1,D=/^([\w-\.]+)@([\w-]+(?:\.[\w-]+){1,3})$/,
A={"163.com":[2,1,1,1],"qq.com":[2,0,1],"sina.com":[2,0,1],"126.com":[2,1,1,1],"vip.qq.com":[2,0,1],"yahoo.com":[2,0,0],"yahoo.com.cn":[2,0,0],"yahoo.cn":[2,0,0],"sohu.com":[2,0,0],"gmail.com":[1,0,0],"hotmail.com":[1,0,0],"yeah.net":[2,1,0,1],"sina.cn":[2,0,0],"live.com":[2,0,0],"sogou.com":[2,0,0],"139.com":[1,0,0],"wo.com.cn":[2,0,0],"21cn.com":[2,0,0],"vip.163.com":[1,1,0],"vip.126.com":[1,1,0],"188.com":[2,1,0],"foxmail.com":[1,0,0]},k={username:{txt:"\u7f51\u6613\u90ae\u7bb1\u7528\u6237\u53ef\u76f4\u63a5\u767b\u5f55",
"class":"inp-tips"},password:{txt:"6-16\u4f4d\u5b57\u7b26\uff0c\u533a\u5206\u5927\u5c0f\u5199","class":"inp-tips"},m_username:{txt:"\u8bf7\u8f93\u516511\u4f4d\u624b\u673a\u53f7","class":"inp-tips"}},K=function(a,b){var c=h.getCurrentRegType();a.ot=z.end_and_get();c==1?r("submit",a,function(d){z.start();var e=d.num>=200&&d.num<=202,m=!1,l=a[h.getCurrentUA()];$.isFunction(b)&&b(e,d.is163Mail);if(e)I(d.is163Mail),h.currentItems.reset();else switch(n(2,0,3),d.num){case 2:h.currentItems.get("captcha")&&
(E(),h.currentItems.get("captcha").none());n(2,0,5);break;case 107:m=!0}G({regType:c,success:e,reVer:m,status:d.num,msg:d.msg.indexOf("\uff1b")==0?d.msg.replace("\uff1b",""):d.msg,url:d.reDirectUrl?(d.reDirectUrl.indexOf("?")==-1?d.reDirectUrl+"?":d.reDirectUrl+"&")+"username="+a.username:"",username:l,is163Mail:d.is163Mail,mailUrl:d.mailUrl});v=!1}):r("regMobile",a,function(a){$.isFunction(b)&&b(a.success);G({regType:c,success:a.success,msg:a.msg,status:a.status,url:a.reDirectUrl?(a.reDirectUrl.indexOf("?")==
-1?a.reDirectUrl+"?":a.reDirectUrl+"&")+"username="+a.UA:"",username:a.UA,m_username:parseInt(a.mUA)});v=!1;a.status==413&&n(1,0,4)},!0)},O=function(a){var b=!0;/^[a-z]/i.test(a)?/[^a-z\d]$/i.test(a)?b="\u8bf7\u8f93\u5165\u5b57\u6bcd\u6216\u6570\u5b57\u7ed3\u5c3e":/[^a-z\d_]/i.test(a)?b="\u8bf7\u8f93\u5165\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf":/^[a-z\d_]{6,18}$/i.test(a)||(b="\u8bf7\u8f93\u51656\u523018\u4e2a\u5b57\u7b26"):b="\u8bf7\u8f93\u5165\u5b57\u6bcd\u5f00\u5934";return b},
w=function(a){var b=[],c;for(c in a)b.push(c+"="+a[c]);return b.join("&")},r=function(a,b,c){$.ajax({type:"get",async:!1,url:(a=="submit"?"https://reg.nie.163.com/web/quick/":"http://weburs.ku.163.com/quickReg/")+a+"?"+w($.extend({promark:x,id:C,output:"json"},b)),dataType:"jsonp",success:function(a){c(a)}})},I=function(a){(function(){var b=h.currentItems.getVal(h.getCurrentUA());setTimeout(function(){$.include("http://union.netease.com/sys_js/pre_related.js",function(){a?netease_union_pre_related(b):
netease_union_pre_related(b,2)})},0)})()},H=function(){var a=$(new Image);a.bind("readystatechange",function(){}).bind("abort",function(){});return a},F=new function(){var a=this,b=!1;this.got=!1;this.load=function(c){!a.got&&!b&&(b=!0,r("IdCreator",{},function(d){C=d.id;a.got=!0;b=!1;$.isFunction(c)&&c()}))}},B=function(){var a=this;this.has=this.doing=!1;this.load=function(b,c){a.has=!0;if(!a.doing){a.doing=!0;_size=b?{w:205,h:30}:{w:100,h:30};var d=function(){return H().attr({height:_size.h,width:_size.w,
src:"http://weburs.ku.163.com/quickReg/Img?"+w({id:C,pAnti:b?1:0,promark:x,_r:(new Date).getTime()})})};F.got?(a.doing=!1,c(d())):F.load(function(){a.doing=!1;c(d())})}}},P=function(a){var b=this,c=$.extend({},{name:null,asy:!1,rule:null,focusCallBack:null,form:null},a),d=c.form.find("dd.qr-"+c.name),e=d.find("li.qrChk"),h=function(a){f.unbind("blur");l(a)},l=function(a){f.blur({f:a},function(a,c){$.isFunction(a.data.f)&&a.data.f();b.none();c&&$.isFunction(c.chkCallBack)?b.chk(c.chkCallBack):b.chk()})},
f=d.find("input[name="+c.name+"]"),j=d.find("input[rel="+c.name+"]");this.val=/password/.test(c.name)?function(){return f.val()}:function(){return $.trim(f.val())};this.passStatus=!1;this.reset=function(){b.none();b.passStatus=!1;b.val("")};this.error=function(a){b.passStatus=!1;f.addClass("qr-hide");j.val(a).removeClass("qr-hide");/^(password|m_password)$/.test(c.name)&&j.removeClass(k.password["class"]).addClass("qr-inp-error");b.none();e.addClass("qr-error")};this.right=function(){b.passStatus=
!0;j.addClass("qr-hide");f.removeClass("qr-hide");b.none();/^(smscode|m_username)$/.test(c.name)||e.addClass("qr-right")};this.loading=function(){b.none();e.addClass("qr-loading")};this.none=function(){e.removeClass("qr-loading qr-error qr-right")};this.chk=function(a){$.isFunction(c.focusCallBack)&&c.focusCallBack();b.loading();var d=function(c){c!=!0?b.error(c):b.right();$.isFunction(a)&&a(b.passStatus)};c.asy&&b.passStatus?d(!0):$.isFunction(c.rule)&&(c.asy?c.rule(b.val(),d):d(c.rule(b.val())))};
this.blur=function(a){f.trigger("blur",{chkCallBack:a})};this.passWordTips=function(){f.addClass("qr-hide");j.val(k.password.txt).addClass(k.password["class"]).removeClass("qr-hide").removeClass("qr-inp-error").focus(function(){f.val()==""&&j.val("").removeClass(k.password["class"]).addClass("qr-inp-error")});b.none()};switch(c.name){case "username":this.hiLine=function(){var a=4,b=setInterval(function(){a==0?clearInterval(b):a%2==0?f.addClass("qr-hiLine"):f.removeClass("qr-hiLine");a--},150);f.val("\u5982 name@163.com").focus(function(){f.val()==
"\u5982 name@163.com"&&f.val("").removeClass("qr-hiLine");f.unbind("focus")})};var g=new function(){var a=this,c=d.find("div>ul").html('<li class="title">\u8bf7\u9009\u62e9\u6216\u7ee7\u7eed\u8f93\u5165...</li>'),e=0,g=0,j=function(){return c.children(":eq("+(e+1)+")")},i=function(){h(function(){g>0&&f.val(j().text());c.parent().hide()})};this.show=function(){c.parent().show();i()};this.hide=function(){l();c.parent().hide()};this.clear=function(){e=g=0;c.empty().html('<li class="title">\u8bf7\u9009\u62e9\u6216\u7ee7\u7eed\u8f93\u5165...</li>')};
this.add=function(d){++g;$("<li>",{text:d,"class":g-1==e?"hover":"",index:g-1,click:function(){f.val($(this).text());a.hide();b.blur()}}).hover(function(){e=parseInt($(this).attr("index"));c.children().removeClass("hover");$(this).addClass("hover")}).appendTo(c)};this.down=function(){g>1&&(e=e==g-1?0:e+1,j().triggerHandler("mouseover"));i()};this.up=function(){g>1&&(e=e==0?g-1:e-1,j().triggerHandler("mouseover"));i()}};f.keyup(function(a){switch(a.which){case 38:g.up();break;case 40:g.down();break;
default:g.clear();var b=$(this).val(),a=0;if(b!=""){var c=b.match(/^([\w-\.]+)@([^$]*)/);if(c){var b=c[2].toLowerCase(),d;for(d in A)d.indexOf(b)==0&&++a<6&&g.add(c[1]+"@"+d)}else for(d in A)++a<6&&g.add(b+"@"+d)}a==0?g.hide():g.show()}}).val(k.username.txt).addClass(k.username["class"]).focus(function(){f.val()==k.username.txt&&f.val("").removeClass(k.username["class"]);f.unbind("focus")});break;case "password":this.passWordTips();break;case "m_password":this.passWordTips();break;case "captcha":var i=
d.find("span");this.showCaptchaLoading=function(){i.empty().show()};this.showCaptcha=function(a){i.append(a)};this.hideCaptcha=function(){i.empty().hide()};break;case "m_username":f.val(k.m_username.txt).addClass(k.m_username["class"]).focus(function(){f.val()==k.m_username.txt&&f.val("").removeClass(k.m_username["class"]);f.unbind("focus")})}c.asy&&f.keyup(function(){b.passStatus=!1});l();$.isFunction(c.focusCallBack)&&f.focus(c.focusCallBack);j.focus(function(){b.none();f.removeClass("qr-hide").trigger("focus");
j.addClass("qr-hide")})},L=function(a,b,c){var d=this,e={},h=!1,l=a.length;this.get=function(a){return e[a]};this.blur=function(a){d.get(a).blur()};this.getVal=function(a){return d.get(a).val()};this.clear=function(){l=0;e={}};this.chkAll=function(a,b){if(!h){h=!0;var c=0,f=0,g;for(g in e)d.get(g).blur(function(d){++f;d&&++c;f==l&&(h=!1,c==l?a():b())})}};this.getItemVals=function(){var a={},b;for(b in e)/repassword/.test(b)||(a[b]=/^(password|activityid1|activityid2)$/.test(b)?encodeURIComponent(encodeURIComponent(d.getVal(b))):
d.getVal(b));return a};this.reset=function(){b[0].reset();for(var a in e)e[a].reset()};for(var f=0,j=a.length;f<j;f++){var g=a[f].name,i=J[g];i.name=g;i.form=b;$.isFunction(c)&&(i.focusCallBack=c);e[g]=new P(i)}},y=function(a){var b=this,c=[],d=[],e=1,i=$("<ul class=qr-tab>").appendTo(t),l=[],f=[],j=function(a){e=a;b.currentItems=c[e].items;for(var a=0,d=c.length;a<d;a++)a!=e&&(c[a].form.hide(),l[a].removeClass("qr-tab-current"));c[e].form.show();l[e].addClass("qr-tab-current")};this.getCurrentRegType=
function(){return f[e]};this.currentItems=null;this.getCurrentUA=function(){return d[e].name};this.getForm=function(){return c[e].form};this.active=function(a){for(var b=0,c=l.length;b<c;b++)if(l[b].text()==a){j(b);break}};for(var g=0,n=a.length;g<n;g++){for(var k=o.activity,p=0,r=k.length;p<r&&p<2;p++){var s="activityid"+(p+1);a[g].names.push({cn:k[p].name,name:s,defaultValue:k[p].defaultValue});J[s]={rule:k[p].rule}}d.push(a[g].names[0]);f.push(a[g].regType);(function(){var b=g;l[g]=$("<li>",{text:a[g].tabName,
"class":"qr-tab-"+(g+1)+(e==g?" qr-tab-current":"")}).appendTo(i).click(function(){q.touch();j(b)}).appendTo(i)})();k=N(a[g].names,g);p=$.isFunction(a[g].focusCallBack)?new L(a[g].names,k,a[g].focusCallBack):new L(a[g].names,k);g==e?b.currentItems=p:k.hide();k.submit({regCallback:a[g].regCallBack},function(a){q.touch();x?$(a.target).find("input[name=agree]").is(":checked")?v||(v=!0,h.currentItems.chkAll(function(){K(h.currentItems.getItemVals(),a.data.regCallback)},function(){v=!1})):alert("\u5fc5\u987b\u63a5\u53d7\u670d\u52a1\u6761\u6b3e\u624d\u80fd\u6ce8\u518c\u3002"):
alert("\u6ce8\u518c\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u5ba2\u670d\u3002[1]")});t.append(k);c.push({items:p,form:k})}},h=null;t.empty();switch(o.type){case 1:var u=new B,E=function(){var a=h.currentItems.get("captcha"),b=arguments.callee;a.showCaptchaLoading();u.load(!1,function(c){c.click(b);a.showCaptcha(c)})},h=new y([{tabName:"\u90ae\u7bb1\u6ce8\u518c",names:[{cn:"\u90ae\u4ef6\u5730\u5740",name:"username"},{cn:"\u8bbe\u7f6e\u5bc6\u7801",name:"password"},{cn:"\u786e\u8ba4\u5bc6\u7801",name:"repassword"},
{cn:"\u9a8c\u8bc1\u7801",name:"captcha"}],focusCallBack:function(){q.touch();z.firstStart();!u.has&&!u.doing&&E()},regCallBack:function(a,b){if(a)u.has=!1,h.currentItems.get("captcha").hideCaptcha(),q.run(b?100:101),n(2,b?1:0)},regType:1},{tabName:"\u624b\u673a\u6ce8\u518c",names:[{cn:"\u624b\u673a\u53f7\u7801",name:"m_username"},{cn:"\u9a8c\u8bc1\u7801",name:"smscode"},{cn:"\u8bbe\u7f6e\u5bc6\u7801",name:"m_password"},{cn:"\u786e\u8ba4\u5bc6\u7801",name:"m_repassword"}],regType:2,regCallBack:function(a){a&&
(q.run(200),n(1,1))}}]);break;case 2:h=new y([{tabName:"\u90ae\u7bb1\u6ce8\u518c",names:[{cn:"\u90ae\u4ef6\u5730\u5740",name:"username"},{cn:"\u8bbe\u7f6e\u5bc6\u7801",name:"password"},{cn:"\u786e\u8ba4\u5bc6\u7801",name:"repassword"}],focusCallBack:function(){q.touch();z.firstStart();F.load()},regCallBack:function(a,b){a&&(q.run(b?100:101),n(2,b?1:0))},regType:1},{tabName:"\u624b\u673a\u6ce8\u518c",names:[{cn:"\u624b\u673a\u53f7\u7801",name:"m_username"},{cn:"\u9a8c\u8bc1\u7801",name:"smscode"},
{cn:"\u8bbe\u7f6e\u5bc6\u7801",name:"m_password"},{cn:"\u786e\u8ba4\u5bc6\u7801",name:"m_repassword"}],regType:2,regCallBack:function(a){a&&(n(1,1),q.run(200))}}])}q.run(1)};
